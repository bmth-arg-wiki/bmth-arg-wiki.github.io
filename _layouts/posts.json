[
  {% assign all_pages = site.pages | concat: site.posts %}
  {% if page.target == "home" %}
  {%- assign pages = all_pages -%}
  {% else %}
  {%- assign pages = all_pages | where_exp:"item", "item.categories contains page.target" -%}
  {% endif %}
  {%- for subPost in pages -%}
  {
    "title": "{{ subPost.title | xml_escape }}",
    "description": "{{ subPost.description | xml_escape }}",
    "url": "{{ site.url }}{{ subPost.url }}",
    "date": "{{ subPost.last_modified_at | date_to_xmlschema }}",
    "category": "{{ subPost.categories }}"
  }
  {%- unless forloop.last -%},{%- endunless -%}
  {%- endfor -%}
]